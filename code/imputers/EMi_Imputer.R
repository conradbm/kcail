install.packages('Amelia')
library(Amelia)

setwd("/Users/bmc/Desktop/KCAIL/KState_Data_Exploration/data/")
df1 <- read.csv('Selleck_filtered_padel_corrected.csv', header=TRUE)
df1 <- df1[,colnames(df1)[(colnames(df1) %in% colnames(df9))]]
#df2 <- read.csv('Akt1_decoys_padel.csv', header=TRUE)
#df3 <- read.csv('AmpC_decoys_padel.csv', header=TRUE)
#df4 <- read.csv('cp3a4_decoys_padel.csv', header=TRUE)
#df5 <- read.csv('cxcr4_decoys_padel.csv', header=TRUE)
#df6 <- read.csv('HIVpr_decoys_padel.csv', header=TRUE)
#df7 <- read.csv('HIVrt_decoys_padel.csv', header=TRUE)
#df8 <- read.csv('Kif11_decoys_padel.csv', header=TRUE)
df9 <- read.csv('Series3_6.15.17_padel.csv', header=TRUE)
df9$IC50 <- runif(nrow(df9), min=50, max=100)

colnames(df1)[1:5]
colnames(df1)[(ncol(df1)-5):ncol(df1)]
#colnames(df2)[1:5]
#colnames(df3)[1:5]
#colnames(df4)[1:5]
#colnames(df5)[1:5]
#colnames(df6)[1:5]
#colnames(df7)[1:5]
#colnames(df8)[1:5]
colnames(df9)[1:5]
colnames(df9)[(ncol(df9)-5):ncol(df9)]

amelia(df1[,2:ncol(df1)])
#amelia(df2[,2:ncol(df2)])
#amelia(df3[,2:ncol(df3)])
#amelia(df4[,2:ncol(df4)])
#amelia(df5[,2:ncol(df5)])
#amelia(df6[,2:ncol(df6)])
#amelia(df7[,2:ncol(df7)])
#amelia(df8[,2:ncol(df8)])
amelia(df9[,2:ncol(df9)])

colnames(df1)[!(colnames(df1)%in%colnames(df9))]

bad_df1 <- c('ATSC0s',
             'AATSC0s',
             'SpAbs_DzZ',
             'SpMax_DzZ',
             'SpDiam_DzZ',
             'SpAD_DzZ',
             'SpMAD_DzZ',
             'EE_DzZ',
             'SM1_DzZ',
             'VE1_DzZ',
             'VE2_DzZ',
             'VE3_DzZ',
             'VR1_DzZ',
             'VR2_DzZ',
             'VR3_DzZ',
             'SpAbs_Dzm',
             'SpMax_Dzm',
             'SpDiam_Dzm',
             'SpAD_Dzm',
             'SpMAD_Dzm',
             'EE_Dzm',
             'SM1_Dzm',
             'VE1_Dzm',
             'VE2_Dzm',
             'VE3_Dzm',
             'VR1_Dzm',
             'VR2_Dzm',
             'VR3_Dzm',
             'SpAbs_Dzv',
             'SpMax_Dzv',
             'SpDiam_Dzv',
             'SpAD_Dzv',
             'SpMAD_Dzv',
             'EE_Dzv',
             'SM1_Dzv',
             'VE1_Dzv',
             'VE2_Dzv',
             'VE3_Dzv',
             'VR1_Dzv',
             'VR2_Dzv',
             'VR3_Dzv',
             'SpAbs_Dze',
             'SpMax_Dze',
             'SpDiam_Dze',
             'SpAD_Dze',
             'SpMAD_Dze',
             'EE_Dze',
             'SM1_Dze',
             'VE1_Dze',
             'VE2_Dze',
             'VE3_Dze',
             'VR1_Dze',
             'VR2_Dze',
             'VR3_Dze',
             'SpAbs_Dzp',
             'SpMax_Dzp',
             'SpDiam_Dzp',
             'SpAD_Dzp',
             'SpMAD_Dzp',
             'EE_Dzp',
             'SM1_Dzp',
             'VE1_Dzp',
             'VE2_Dzp',
             'VE3_Dzp',
             'VR1_Dzp',
             'VR2_Dzp',
             'VR3_Dzp',
             'SpAbs_Dzi',
             'SpMax_Dzi',
             'SpDiam_Dzi',
             'SpAD_Dzi',
             'SpMAD_Dzi',
             'EE_Dzi',
             'SM1_Dzi',
             'VE1_Dzi',
             'VE2_Dzi',
             'VE3_Dzi',
             'VR1_Dzi',
             'VR2_Dzi',
             'VR3_Dzi',
             'SpAbs_Dzs',
             'SpMax_Dzs',
             'SpDiam_Dzs',
             'SpAD_Dzs',
             'SpMAD_Dzs',
             'EE_Dzs',
             'SM1_Dzs',
             'VE1_Dzs',
             'VE2_Dzs',
             'VE3_Dzs',
             'VR1_Dzs',
             'SpMax1_Bhm',
             'SpMax2_Bhm',
             'SpMax3_Bhm',
             'SpMax4_Bhm',
             'SpMax5_Bhm',
             'SpMax6_Bhm',
             'SpMax7_Bhm',
             'SpMax8_Bhm',
             'SpMin1_Bhm',
             'SpMin2_Bhm',
             'SpMin3_Bhm',
             'SpMin4_Bhm',
             'SpMin5_Bhm',
             'SpMin6_Bhm',
             'SpMin7_Bhm',
             'SpMin8_Bhm',
             'SpMax1_Bhv',
             'SpMax2_Bhv',
             'SpMax3_Bhv',
             'SpMax4_Bhv',
             'SpMax5_Bhv',
             'SpMax6_Bhv',
             'SpMax7_Bhv',
             'SpMax8_Bhv',
             'SpMin1_Bhv',
             'SpMin2_Bhv',
             'SpMin3_Bhv',
             'SpMin4_Bhv',
             'SpMin5_Bhv',
             'SpMin6_Bhv',
             'SpMin7_Bhv',
             'SpMin8_Bhv',
             'SpMax1_Bhe',
             'SpMax2_Bhe',
             'SpMax3_Bhe',
             'SpMax4_Bhe',
             'SpMax5_Bhe',
             'SpMax6_Bhe',
             'SpMax7_Bhe',
             'SpMax8_Bhe',
             'SpMin1_Bhe',
             'SpMin2_Bhe',
             'SpMin3_Bhe',
             'SpMin4_Bhe',
             'SpMin5_Bhe',
             'SpMin6_Bhe',
             'SpMin7_Bhe',
             'SpMin8_Bhe',
             'SpMax1_Bhp',
             'SpMax2_Bhp',
             'SpMax3_Bhp',
             'SpMax4_Bhp',
             'SpMax5_Bhp',
             'SpMax6_Bhp',
             'SpMax7_Bhp',
             'SpMax8_Bhp',
             'SpMin1_Bhp',
             'SpMin2_Bhp',
             'SpMin3_Bhp',
             'SpMin4_Bhp',
             'SpMin5_Bhp',
             'SpMin6_Bhp',
             'SpMin7_Bhp',
             'SpMin8_Bhp',
             'SpMax1_Bhi',
             'SpMax2_Bhi',
             'SpMax3_Bhi',
             'SpMax4_Bhi',
             'SpMax5_Bhi',
             'SpMax6_Bhi',
             'SpMax7_Bhi',
             'SpMax8_Bhi',
             'SpMin1_Bhi',
             'SpMin2_Bhi',
             'SpMin3_Bhi',
             'SpMin4_Bhi',
             'SpMin5_Bhi',
             'SpMin6_Bhi',
             'SpMin7_Bhi',
             'SpMin8_Bhi',
             'SpMax1_Bhs',
             'SpMax2_Bhs',
             'SpMax3_Bhs',
             'SpMax4_Bhs',
             'SpMax5_Bhs',
             'SpMax6_Bhs',
             'SpMax7_Bhs',
             'SpMax8_Bhs',
             'SpMin1_Bhs',
             'SpMin2_Bhs',
             'SpMin3_Bhs',
             'SpMin4_Bhs',
             'SpMin5_Bhs',
             'SpMin6_Bhs',
             'ETA_EtaP_F' )

bad_df9 <- c('nAcid',
             'nP',
             'nBondsT',
             'nBondsQ',
             'C1SP1',
             'C2SP1',
             'SCH.3',
             'SCH.4',
             'VCH.3',
             'VCH.4',
             'nwHBd',
             'nHBint8',
             'nHdNH',
             'nHsSH',
             'nHsNH3p',
             'nHssNH2p',
             'nHsssNHp',
             'nHtCH',
             'nHdCH2',
             'nHCHnX',
             'nHAvin',
             'nHmisc',
             'nsLi',
             'nssBe',
             'nssssBem',
             'nsBH2',
             'nssBH',
             'nssssBm',
             'ndCH2',
             'ntCH',
             'nddC',
             'ntsC',
             'nsNH3p',
             'nssNH2p',
             'ndNH',
             'ntN',
             'nsssNHp',
             'nddsN',
             'nssssNp',
             'naaO',
             'naOm',
             'nsOm',
             'nsSiH3',
             'nssSiH2',
             'nsssSiH',
             'nssssSi',
             'nsPH2',
             'nssPH',
             'nsssP',
             'ndsssP',
             'nddsP',
             'nsssssP',
             'nsSH',
             'ndS',
             'ndssS',
             'nssssssS',
             'nSm',
             'nsGeH3',
             'nssGeH2',
             'nsssGeH',
             'nssssGe',
             'nsAsH2',
             'nssAsH',
             'nsssAs',
             'ndsssAs',
             'nddsAs',
             'nsssssAs',
             'nsSeH',
             'ndSe',
             'nssSe',
             'naaSe',
             'ndssSe',
             'nssssssSe',
             'nddssSe',
             'nsSnH3',
             'nssSnH2',
             'nsssSnH',
             'nssssSn',
             'nsPbH3',
             'nssPbH2',
             'nsssPbH',
             'nssssPb',
             'SwHBd',
             'SHBint8',
             'SHdNH',
             'SHsSH',
             'SHsNH3p',
             'SHssNH2p',
             'SHsssNHp',
             'SHtCH',
             'SHdCH2',
             'SHCHnX',
             'SHAvin',
             'SHmisc',
             'SsLi',
             'SssBe',
             'SssssBem',
             'SsBH2',
             'SssBH',
             'SssssBm',
             'SdCH2',
             'StCH',
             'SddC',
             'StsC',
             'SsNH3p',
             'SssNH2p',
             'SdNH',
             'StN',
             'SsssNHp',
             'SddsN',
             'SssssNp',
             'SaaO',
             'SaOm',
             'SsOm',
             'SsSiH3',
             'SssSiH2',
             'SsssSiH',
             'SssssSi',
             'SsPH2',
             'SssPH',
             'SsssP',
             'SdsssP',
             'SddsP',
             'SsssssP',
             'SsSH',
             'SdS',
             'SdssS',
             'SssssssS',
             'SSm',
             'SsGeH3',
             'SssGeH2',
             'SsssGeH',
             'SssssGe',
             'SsAsH2',
             'SssAsH',
             'SsssAs',
             'SdsssAs',
             'SddsAs',
             'SsssssAs',
             'SsSeH',
             'SdSe',
             'SssSe',
             'SaaSe',
             'SdssSe',
             'SssssssSe',
             'SddssSe',
             'SsSnH3',
             'SssSnH2',
             'SsssSnH',
             'SssssSn',
             'SsPbH3',
             'SssPbH2',
             'SsssPbH',
             'SssssPb',
             'minwHBd',
             'minHBint8',
             'minHdNH',
             'minHsSH',
             'minHsNH3p',
             'minHssNH2p',
             'minHsssNHp',
             'minHtCH',
             'minHdCH2',
             'minHCHnX',
             'minHAvin',
             'minHmisc',
             'minsLi',
             'minssBe',
             'minssssBem',
             'minsBH2',
             'minssBH',
             'minssssBm',
             'mindCH2',
             'mintCH',
             'minddC',
             'mintsC',
             'minsNH3p',
             'minssNH2p',
             'mindNH',
             'mintN',
             'minsssNHp',
             'minddsN',
             'minssssNp',
             'minaaO',
             'minaOm',
             'minsOm',
             'minsSiH3',
             'minssSiH2',
             'minsssSiH',
             'minssssSi',
             'minsPH2',
             'minssPH',
             'minsssP',
             'mindsssP',
             'minddsP',
             'minsssssP',
             'minsSH',
             'mindS',
             'mindssS',
             'minssssssS',
             'minSm',
             'minsGeH3',
             'minssGeH2',
             'minsssGeH',
             'minssssGe',
             'minsAsH2',
             'minssAsH',
             'minsssAs',
             'mindsssAs',
             'minddsAs',
             'minsssssAs',
             'minsSeH',
             'mindSe',
             'minssSe',
             'minaaSe',
             'mindssSe',
             'minssssssSe',
             'minddssSe',
             'minsSnH3',
             'minssSnH2',
             'minsssSnH',
             'minssssSn',
             'minsPbH3',
             'minssPbH2',
             'minsssPbH',
             'minssssPb',
             'maxwHBd',
             'maxHBint8',
             'maxHdNH',
             'maxHsSH',
             'maxHsNH3p',
             'maxHssNH2p',
             'maxHsssNHp',
             'maxHtCH',
             'maxHdCH2',
             'maxHCHnX',
             'maxHAvin',
             'maxHmisc',
             'maxsLi',
             'maxssBe',
             'maxssssBem',
             'maxsBH2',
             'maxssBH',
             'maxsssB',
             'maxssssBm',
             'maxdCH2',
             'maxtCH',
             'maxddC',
             'maxtsC',
             'maxsNH3p',
             'maxssNH2p',
             'maxdNH',
             'maxtN',
             'maxsssNHp',
             'maxddsN',
             'maxssssNp',
             'maxaaO',
             'maxaOm',
             'maxsOm',
             'maxsSiH3',
             'maxssSiH2',
             'maxsssSiH',
             'maxssssSi',
             'maxsPH2',
             'maxssPH',
             'maxsssP',
             'maxdsssP',
             'maxddsP',
             'maxsssssP',
             'maxsSH',
             'maxdS',
             'maxssS',
             'maxaaS',
             'maxdssS',
             'maxddssS',
             'maxssssssS',
             'maxSm',
             'maxsGeH3',
             'maxssGeH2',
             'maxsssGeH',
             'maxssssGe',
             'maxsAsH2',
             'maxssAsH',
             'maxsssAs',
             'maxdsssAs',
             'maxddsAs',
             'maxsssssAs',
             'maxsSeH',
             'maxdSe',
             'maxssSe',
             'maxaaSe',
             'maxdssSe',
             'maxssssssSe',
             'maxddssSe',
             'maxsSnH3',
             'maxssSnH2',
             'maxsssSnH',
             'maxssssSn',
             'maxsPbH3',
             'maxssPbH2',
             'maxsssPbH',
             'maxssssPb',
             'n3Ring',
             'n4Ring',
             'n7Ring',
             'n8Ring',
             'n9Ring',
             'n10Ring',
             'n11Ring',
             'n12Ring',
             'nG12Ring',
             'nF4Ring',
             'nF5Ring',
             'nF6Ring',
             'nF7Ring',
             'nF8Ring',
             'nF11Ring',
             'nF12Ring',
             'nFG12Ring',
             'nT4Ring',
             'nT7Ring',
             'nT8Ring',
             'nT11Ring',
             'nT12Ring',
             'nTG12Ring',
             'n3HeteroRing',
             'n4HeteroRing',
             'n7HeteroRing',
             'n8HeteroRing',
             'n9HeteroRing',
             'n10HeteroRing',
             'n11HeteroRing',
             'n12HeteroRing',
             'nG12HeteroRing',
             'nFHeteroRing',
             'nF4HeteroRing',
             'nF5HeteroRing',
             'nF6HeteroRing',
             'nF7HeteroRing',
             'nF8HeteroRing',
             'nF11HeteroRing',
             'nF12HeteroRing',
             'nFG12HeteroRing',
             'nTHeteroRing',
             'nT4HeteroRing',
             'nT7HeteroRing',
             'nT8HeteroRing',
             'nT11HeteroRing',
             'nT12HeteroRing',
             'nTG12HeteroRing',
             'SRW3')

bad_2_df1 <- c('ATS1s',
          'ATS2s',
          'AATS1s',
          'AATS2s',
          'ATSC1s',
          'ATSC2s',
          'ATSC3s',
          'ATSC4s',
          'ATSC5s',
          'ATSC6s',
          'AATSC1s',
          'AATSC2s',
          'AATSC3s',
          'AATSC4s',
          'AATSC5s',
          'AATSC6s',
          'MATS1s',
          'MATS2s',
          'MATS3s',
          'MATS4s',
          'MATS5s',
          'MATS6s',
          'GATS1s',
          'GATS2s',
          'GATS3s',
          'GATS4s',
          'GATS5s',
          'GATS6s',
          'GATS7s',
          'GATS8s',
          'SpMin8_Bhs',
          'SCH.5',
          'SCH.6',
          'SCH.7',
          'VCH.5',
          'VCH.6',
          'VCH.7',
          'SC.3',
          'SC.4',
          'SC.5',
          'SC.6',
          'VC.3',
          'VC.4',
          'VC.5',
          'VC.6',
          'SPC.4',
          'SPC.5',
          'SPC.6',
          'VPC.4',
          'VPC.5',
          'VPC.6',
          'SP.0',
          'SP.1',
          'SP.2',
          'SP.3',
          'SP.4',
          'SP.5',
          'SP.6',
          'SP.7',
          'ASP.0',
          'ASP.1',
          'ASP.2',
          'ASP.3',
          'ASP.4',
          'ASP.5',
          'ASP.6',
          'ASP.7',
          'VP.1',
          'VP.2',
          'VP.3',
          'VP.4',
          'VP.5',
          'VP.6',
          'VP.7',
          'AVP.1',
          'AVP.2',
          'AVP.3',
          'AVP.4',
          'AVP.5',
          'nHBa',
          'nwHBa',
          'nHBint2',
          'nHBint3',
          'nHBint4',
          'nHBint5',
          'nHBint6',
          'nHBint7',
          'nHBint9',
          'nHBint10',
          'nHsOH',
          'nHsNH2',
          'nHssNH',
          'nHaaNH',
          'nHdsCH',
          'nHaaCH',
          'nHCsats',
          'nHCsatu',
          'nHother',
          'nsssB',
          'nsCH3',
          'nssCH2',
          'ndsCH',
          'naaCH',
          'nsssCH',
          'ndssC',
          'naasC',
          'naaaC',
          'nssssC',
          'nsNH2',
          'nssNH',
          'naaNH',
          'ndsN',
          'naaN',
          'nsssN',
          'naasN',
          'nsOH',
          'ndO',
          'nssO',
          'nsF',
          'nssS',
          'naaS',
          'nddssS',
          'nsCl',
          'nsBr',
          'nsI',
          'SHBa',
          'SwHBa',
          'SHBint2',
          'SHBint3',
          'SHBint4',
          'SHBint5',
          'SHBint6',
          'SHBint7',
          'SHBint9',
          'SHBint10',
          'SHsOH',
          'SHsNH2',
          'SHssNH',
          'SHaaNH',
          'SHdsCH',
          'SHaaCH',
          'SHCsats',
          'SHCsatu',
          'SHother',
          'SsssB',
          'SsCH3',
          'SssCH2',
          'SdsCH',
          'SaaCH',
          'SsssCH',
          'SdssC',
          'SaasC',
          'SaaaC',
          'SssssC',
          'SsNH2',
          'SssNH',
          'SaaNH',
          'SdsN',
          'SaaN',
          'SsssN',
          'SaasN',
          'SsOH',
          'SdO',
          'SssO',
          'SsF',
          'SssS',
          'SaaS',
          'SddssS',
          'SsCl',
          'SsBr',
          'SsI',
          'minHBa',
          'minwHBa',
          'minHBint2',
          'minHBint3',
          'minHBint4',
          'minHBint5',
          'minHBint6',
          'minHBint7',
          'minHBint9',
          'minHBint10',
          'minHsOH',
          'minHsNH2',
          'minHssNH',
          'minHaaNH',
          'minHdsCH',
          'minHaaCH',
          'minHCsats',
          'minHCsatu',
          'minHother',
          'minsssB',
          'minsCH3',
          'minssCH2',
          'mindsCH',
          'minaaCH',
          'minsssCH',
          'mindssC',
          'minaasC',
          'minaaaC',
          'minssssC',
          'minsNH2',
          'minssNH',
          'minaaNH',
          'mindsN',
          'minaaN',
          'minsssN',
          'minaasN',
          'minsOH',
          'mindO',
          'minssO',
          'minsF',
          'minssS',
          'minaaS',
          'minddssS',
          'minsCl',
          'minsBr',
          'minsI',
          'maxHBa',
          'maxwHBa',
          'maxHBint2',
          'maxHBint3',
          'maxHBint4',
          'maxHBint5',
          'maxHBint6',
          'maxHBint7',
          'maxHBint9',
          'maxHBint10',
          'maxHsOH',
          'maxHsNH2',
          'maxHssNH',
          'maxHaaNH',
          'maxHdsCH',
          'maxHaaCH',
          'maxHCsats',
          'maxHCsatu',
          'maxHother',
          'maxsCH3',
          'maxssCH2',
          'maxdsCH',
          'maxaaCH',
          'maxsssCH',
          'maxdssC',
          'maxaasC',
          'maxaaaC',
          'maxssssC',
          'maxsNH2',
          'maxssNH',
          'maxaaNH',
          'maxdsN',
          'maxaaN',
          'maxsssN',
          'maxaasN',
          'maxsOH',
          'maxdO',
          'maxssO',
          'maxsF',
          'maxsCl',
          'maxsBr',
          'maxsI',
          'ETA_dEpsilon_B',
          'ETA_dPsi_B',
          'ETA_Shape_P',
          'ETA_Beta_s',
          'ETA_BetaP_s',
          'ETA_dBeta',
          'ETA_dBetaP',
          'ETA_Eta_F_L',
          'ETA_EtaP_F_L',
          'ETA_Eta_B',
          'ETA_EtaP_B')

bad <- c(bad_df1, bad_df9, bad_2_df1)


df1 <- df1[,!(colnames(df1) %in% unique(bad))]
df1 <- apply(df1, 2, function(x) as.numeric(x))

df2 <- df2[,!(colnames(df2) %in% unique(bad))]
df2 <- apply(df2, 2, function(x) as.numeric(x))


df1_amelia <- amelia(df1[,2:ncol(df1)], 
                     parallel = c("snow"),
                     m=1,
                     p2s=2,
                     max.resample=1,
                     boot.type="none",
                     ncpus=4)

df2_amelia <- amelia(df2[,2:ncol(df2)], 
                     parallel = c("snow"),
                     m=1,
                     p2s=2,
                     max.resample=1,
                     boot.type="none",
                     ncpus=4)